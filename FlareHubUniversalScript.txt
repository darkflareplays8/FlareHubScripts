-- ðŸ”¥ FlareHub V2 - SAB AUTO COLLECT FIXED (NO TP + NO KICK)
getgenv().SecureMode = true

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
Rayfield:LoadConfiguration()

local Window = Rayfield:CreateWindow({
   Name = "ðŸ”¥ FlareHub V2",
   LoadingTitle = "FlareHub V2",
   LoadingSubtitle = "Godmode â€¢ Fly â€¢ Noclip â€¢ Walkspeed â€¢ Brainrot",
   ConfigurationSaving = { Enabled = true, FolderName = "FlareHub", FileName = "FlareConfig" },
   Discord = { Enabled = false },
   KeySystem = false
})

local Tab = Window:CreateTab("Main", 4483362458)
local BrainrotTab
local player = game:GetService("Players").LocalPlayer
local RunService = game:GetService("RunService")
task.wait(1)

-- GAME DETECTION
local function isStealABrainrot()
   local success, result = pcall(function()
      return game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name:lower()
   end)
   if success then
      local gameName = result:lower()
      return gameName:find("steal") and gameName:find("brainrot")
   end
   return false
end

-- ULTRA SAFE WALKSPD
local function safeSetWalkspeed(humanoid, speed)
   local targetSpeed = math.clamp(speed, 16, 24)
   spawn(function()
      while math.abs(humanoid.WalkSpeed - targetSpeed) > 0.1 do
         local newSpeed = humanoid.WalkSpeed + (targetSpeed - humanoid.WalkSpeed) * 0.03
         newSpeed = newSpeed + math.random(-1, 1) * 0.03
         humanoid.WalkSpeed = math.clamp(newSpeed, 16, 24)
         wait(0.4)
      end
   end)
end

-- TRUE GODMODE
local godmodeConnection
local function toggleGodmode(Value)
   if not player.Character then return end
   local humanoid = player.Character:FindFirstChild("Humanoid")
   if not humanoid then return end
   
   if Value then
      godmodeConnection = humanoid.HealthChanged:Connect(function(health)
         if health < humanoid.MaxHealth then
            humanoid.Health = humanoid.MaxHealth
         end
      end)
   else
      if godmodeConnection then godmodeConnection:Disconnect() end
   end
end

-- Steal a Brainrot Tab - FIXED AUTO COLLECT
if isStealABrainrot() then
   BrainrotTab = Window:CreateTab("ðŸ§  Steal a Brainrot", 4483362458)
   
   BrainrotTab:CreateToggle({
      Name = "ðŸ¤– Auto Collect (NO TP - SAFE)",
      CurrentValue = false,
      Flag = "AutoCollectToggle",
      Callback = function(Value)
         getgenv().AutoCollectEnabled = Value
         if Value then
            spawn(function()
               while getgenv().AutoCollectEnabled do
                  pcall(function()
                     -- SCAN FOR YOUR BASE COLLECTOR (no TP)
                     for _, obj in pairs(workspace:GetDescendants()) do
                        if obj:IsA("BasePart") and (
                           obj.Name:lower():find("collect") or 
                           obj.Name:lower():find("dropoff") or 
                           obj.Name:lower():find("deposit") or
                           obj.Name:lower():find("cash")
                        ) then
                           local distance = (obj.Position - player.Character.PrimaryPart.Position).Magnitude
                           if distance < 40 then  -- Larger safe range
                              -- FIRE FROM DISTANCE (NO TP = NO DETECT)
                              local clickDetector = obj:FindFirstChildOfClass("ClickDetector")
                              if clickDetector then
                                 fireclickdetector(clickDetector)
                                 Rayfield:Notify({
                                    Title = "Auto Collect",
                                    Content = "Collected from " .. obj.Name,
                                    Duration = 2
                                 })
                                 wait(4)  -- LONG SAB delay
                                 break
                              end
                           end
                        end
                     end
                  end)
                  wait(5)  -- EXTRA SAFE LOOP
               end
            end)
         end
      end,
   })
   
   BrainrotTab:CreateToggle({
      Name = "ðŸ”’ Auto Lock Base",
      CurrentValue = false,
      Flag = "AutoLockToggle",
      Callback = function(Value)
         getgenv().AutoLockEnabled = Value
         if Value then
            spawn(function()
               while getgenv().AutoLockEnabled do
                  -- Find lock button in your base
                  for _, obj in pairs(workspace:GetDescendants()) do
                     if obj.Name:lower():find("lock") and obj:FindFirstChildOfClass("ClickDetector") then
                        local distance = (obj.Position - player.Character.PrimaryPart.Position).Magnitude
                        if distance < 50 then
                           fireclickdetector(obj:FindFirstChildOfClass("ClickDetector"))
                           wait(10)
                           break
                        end
                     end
                  end
                  wait(15)
               end
            end)
         end
      end,
   })
end

-- MAIN TAB
Tab:CreateButton({ Name = "âœ… Test GUI", Callback = function() print("FlareHub SAB SAFE!") end })

Tab:CreateToggle({
   Name = "ðŸ’– True Godmode",
   CurrentValue = false,
   Flag = "GodmodeToggle",
   Callback = function(Value) toggleGodmode(Value) end,
})

Tab:CreateToggle({
   Name = "âœ¨ Noclip",
   CurrentValue = false,
   Flag = "NoclipToggle",
   Callback = function(Value)
      getgenv().NoclipEnabled = Value
      if Value then
         getgenv().NoclipConnection = RunService.Stepped:Connect(function()
            if player.Character then
               for _, part in pairs(player.Character:GetDescendants()) do
                  if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                     part.CanCollide = false
                  end
               end
            end
         end)
      else 
         if getgenv().NoclipConnection then getgenv().NoclipConnection:Disconnect() end
      end
   end,
})

Tab:CreateSlider({
   Name = "Fly Speed",
   Range = {50, 150},
   Increment = 10,
   CurrentValue = 100,
   Flag = "FlySpeedSlider",
   Callback = function(Value) getgenv().FlySpeed = Value end,
})

Tab:CreateToggle({
   Name = "ðŸ•Šï¸ Fly",
   CurrentValue = false,
   Flag = "FlyToggle",
   Callback = function(Value)
      getgenv().FlyEnabled = Value
      local character = player.Character or player.CharacterAdded:Wait()
      local humanoid = character:WaitForChild("Humanoid")
      local rootPart = character:WaitForChild("HumanoidRootPart")
      
      if Value then
         humanoid.PlatformStand = true
         local bodyVelocity = Instance.new("BodyVelocity")
         bodyVelocity.MaxForce = Vector3.new(2000, 2000, 2000)
         bodyVelocity.Velocity = Vector3.new(0, 0, 0)
         bodyVelocity.Parent = rootPart
         
         local bodyGyro = Instance.new("BodyGyro")
         bodyGyro.MaxTorque = Vector3.new(2000, 2000, 2000)
         bodyGyro.P = 2000
         bodyGyro.D = 300
         bodyGyro.CFrame = rootPart.CFrame
         bodyGyro.Parent = rootPart
         
         getgenv().FlyBodyVelocity = bodyVelocity
         getgenv().FlyBodyGyro = bodyGyro
         
         getgenv().FlyConnection = RunService.Heartbeat:Connect(function()
            local camera = workspace.CurrentCamera
            local moveDir = humanoid.MoveDirection
            local speed = getgenv().FlySpeed or 100
            
            if moveDir.Magnitude > 0.05 then
               local camForward = Vector3.new(camera.CFrame.LookVector.X, 0, camera.CFrame.LookVector.Z).Unit
               local camRight = Vector3.new(camera.CFrame.RightVector.X, 0, camera.CFrame.RightVector.Z).Unit
               local velocity = (camForward * -moveDir.Z + camRight * moveDir.X + Vector3.new(0, moveDir.Y, 0)).Unit * speed
               bodyVelocity.Velocity = velocity
            else
               bodyVelocity.Velocity = Vector3.new(0, 0, 0)
            end
            
            bodyGyro.CFrame = camera.CFrame
         end)
      else
         humanoid.PlatformStand = false
         if getgenv().FlyBodyVelocity then getgenv().FlyBodyVelocity:Destroy() end
         if getgenv().FlyBodyGyro then getgenv().FlyBodyGyro:Destroy() end
         if getgenv().FlyConnection then getgenv().FlyConnection:Disconnect() end
      end
   end,
})

Tab:CreateSlider({
   Name = "Walkspeed (Safe)",
   Range = {16, 24},
   Increment = 1,
   CurrentValue = 16,
   Flag = "WalkspeedSlider",
   Callback = function(Value)
      local humanoid = player.Character and player.Character:FindFirstChild("Humanoid")
      if humanoid then safeSetWalkspeed(humanoid, Value) end
   end,
})

-- SAB NOTIFICATION
if isStealABrainrot() then
   Rayfield:Notify({
      Title = "ðŸ§  SAB ULTRA SAFE",
      Content = "Auto Collect FIXED - NO TP + 5s delays!",
      Duration = 6
   })
end

