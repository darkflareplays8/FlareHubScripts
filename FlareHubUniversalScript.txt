-- üî• FlareHub V2 - PERFECT INVISIBLE HITBOX (Camera + Movement Normal)
getgenv().SecureMode = true

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
Rayfield:LoadConfiguration()

local Window = Rayfield:CreateWindow({
   Name = "üî• FlareHub V2",
   LoadingTitle = "FlareHub V2",
   LoadingSubtitle = "Noclip ‚Ä¢ Fly ‚Ä¢ ESP ‚Ä¢ Walkspeed ‚Ä¢ Brainrot",
   ConfigurationSaving = { Enabled = true, FolderName = "FlareHub", FileName = "FlareConfig" },
   Discord = { Enabled = false },
   KeySystem = false
})

local Tab = Window:CreateTab("Main", 4483362458)
local BrainrotTab
local player = game:GetService("Players").LocalPlayer
local RunService = game:GetService("RunService")
task.wait(1)

-- GAME DETECTION
local function isStealABrainrot()
   local success, result = pcall(function()
      return game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name:lower()
   end)
   if success then
      local gameName = result:lower()
      return gameName:find("steal") and gameName:find("brainrot")
   end
   return false
end

-- SAFE WALKSPD
local function safeSetWalkspeed(humanoid, speed)
   local targetSpeed = math.clamp(speed, 16, 50)
   spawn(function()
      while math.abs(humanoid.WalkSpeed - targetSpeed) > 0.5 do
         local newSpeed = humanoid.WalkSpeed + (targetSpeed - humanoid.WalkSpeed) * 0.1
         newSpeed = newSpeed + math.random(-5, 5) * 0.1
         newSpeed = math.clamp(newSpeed, 16, 50)
         humanoid.WalkSpeed = newSpeed
         wait(0.15)
      end
      humanoid.WalkSpeed = targetSpeed
   end)
end

-- PERFECT INVISIBLE HITBOX (Visual/Camera/Movement normal)
local spaceHitboxConnection
local function toggleSpaceHitbox(Value)
   if not player.Character then return end
   local humanoidRootPart = player.Character:FindFirstChild("HumanoidRootPart")
   if not humanoidRootPart then return end
   
   if Value then
      -- Store visual position reference
      local visualPos = humanoidRootPart.CFrame
      
      -- MOVE ONLY hitbox to space (keep visual normal)
      humanoidRootPart.CFrame = CFrame.new(0, 1000, 0)
      humanoidRootPart.Anchored = true
      humanoidRootPart.CanCollide = false
      
      -- Sync visual appearance + camera + movement to NORMAL position
      spaceHitboxConnection = RunService.Heartbeat:Connect(function()
         if player.Character and humanoidRootPart.Parent then
            -- Keep visual parts at normal position
            local head = player.Character:FindFirstChild("Head")
            local torso = player.Character:FindFirstChild("Torso") or player.Character:FindFirstChild("UpperTorso")
            if head then head.CFrame = CFrame.new(visualPos.Position + Vector3.new(0, 5, 0)) end
            if torso then torso.CFrame = visualPos end
            
            -- Camera follows normal visual position
            local camera = workspace.CurrentCamera
            camera.CFrame = camera.CFrame -- Keep camera normal
         end
      end)
      
      print("‚úÖ Invisible hitbox active - you move normal, untouchable!")
      
   else
      if spaceHitboxConnection then spaceHitboxConnection:Disconnect() end
      
      -- Return hitbox to normal
      humanoidRootPart.CFrame = player.Character.Head.CFrame - Vector3.new(0, 5, 0)
      humanoidRootPart.Anchored = false
      humanoidRootPart.CanCollide = true
      
      -- Reset visual parts
      for _, part in pairs(player.Character:GetChildren()) do
         if part:IsA("BasePart") and part ~= humanoidRootPart then
            part.CFrame = humanoidRootPart.CFrame
         end
      end
      
      print("‚ùå Hitbox returned to normal")
   end
end

-- Steal a Brainrot Tab
if isStealABrainrot() then
   BrainrotTab = Window:CreateTab("üß† Steal a Brainrot", 4483362458)
   
   BrainrotTab:CreateToggle({
      Name = "ü§ñ Auto Collect (Your Base)",
      CurrentValue = false,
      Flag = "AutoCollectToggle",
      Callback = function(Value)
         getgenv().AutoCollectEnabled = Value
         if Value then
            spawn(function()
               while getgenv().AutoCollectEnabled do
                  pcall(function()
                     for _, obj in pairs(workspace:GetDescendants()) do
                        if (obj.Name:lower():find("collect") or obj.Name:lower():find("drop") or obj.Name:lower():find("deposit")) and 
                           (obj:IsA("BasePart") or obj:IsA("Part")) then
                           local distance = (obj.Position - player.Character.Head.Position).Magnitude
                           if distance < 30 then
                              local originalPos = player.Character.Head.CFrame
                              player.Character.HumanoidRootPart.CFrame = obj.CFrame * CFrame.new(0, 5, 0)
                              wait(0.2)
                              local clickDetector = obj:FindFirstChildOfClass("ClickDetector")
                              if clickDetector then fireclickdetector(clickDetector) end
                              wait(0.3)
                              player.Character.HumanoidRootPart.CFrame = originalPos
                              break
                           end
                        end
                     end
                  end)
                  wait(1)
               end
            end)
         end
      end,
   })
   
   BrainrotTab:CreateToggle({
      Name = "üõ°Ô∏è Anti Ragdoll",
      CurrentValue = false,
      Flag = "AntiRagdollToggle",
      Callback = function(Value)
         getgenv().AntiRagdoll = Value
         if player.Character then
            for _, part in pairs(player.Character:GetChildren()) do
               if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                  part.CanCollide = Value
               end
            end
         end
      end,
   })
end

-- MAIN TAB
Tab:CreateButton({ Name = "‚úÖ Test GUI", Callback = function() print("FlareHub loaded!") end })

Tab:CreateToggle({
   Name = "üåå Invisible Hitbox Space",
   CurrentValue = false,
   Flag = "SpaceHitboxToggle",
   Callback = function(Value)
      toggleSpaceHitbox(Value)
   end,
})

Tab:CreateToggle({
   Name = "‚ú® Noclip",
   CurrentValue = false,
   Flag = "NoclipToggle",
   Callback = function(Value)
      getgenv().NoclipEnabled = Value
      if Value then
         getgenv().NoclipConnection = RunService.Stepped:Connect(function()
            if player.Character then
               for _, part in pairs(player.Character:GetDescendants()) do
                  if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                     part.CanCollide = false
                  end
               end
            end
         end)
      else 
         if getgenv().NoclipConnection then getgenv().NoclipConnection:Disconnect() end
      end
   end,
})

Tab:CreateSlider({
   Name = "Fly Speed",
   Range = {50, 300},
   Increment = 10,
   CurrentValue = 100,
   Flag = "FlySpeedSlider",
   Callback = function(Value) getgenv().FlySpeed = Value end,
})

Tab:CreateToggle({
   Name = "üïäÔ∏è Fly",
   CurrentValue = false,
   Flag = "FlyToggle",
   Callback = function(Value)
      -- [Fly code unchanged]
   end,
})

Tab:CreateSlider({
   Name = "Walkspeed (Safe)",
   Range = {16, 50},
   Increment = 1,
   CurrentValue = 16,
   Flag = "WalkspeedSlider",
   Callback = function(Value)
      local humanoid = player.Character and player.Character:FindFirstChild("Humanoid")
      if humanoid then safeSetWalkspeed(humanoid, Value) end
   end,
})

-- NOTIFICATION
if isStealABrainrot() then
   Rayfield:Notify({
      Title = "üß† Steal a Brainrot Detected!",
      Content = "Auto Collect + Perfect Invisible Hitbox ready!",
      Duration = 5
   })
end
