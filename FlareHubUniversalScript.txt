-- ðŸ”¥ FlareHub V2 - STEALTH HITBOX BYPASS (SAB SAFE)
getgenv().SecureMode = true
getgenv().AntiCheatBypassActive = true

-- ANTI-CHAT BYPASS FIRST
local mt = getrawmetatable(game)
local oldNamecall = mt.__namecall
setreadonly(mt, false)

mt.__namecall = newcclosure(function(self, ...)
   local method = getnamecallmethod()
   local args = {...}
   
   -- BLOCK SAB ANTI-CHEAT REMOTES [web:395]
   local antiCheatNames = {"AntiCheat", "AC", "Kick", "Ban", "Report", "Check"}
   for _, name in pairs(antiCheatNames) do
      if string.find(self.Name:lower(), name:lower()) and method == "FireServer" then
         return wait(9e9)
      end
   end
   
   return oldNamecall(self, ...)
end)

setreadonly(mt, true)

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
Rayfield:LoadConfiguration()

local Window = Rayfield:CreateWindow({
   Name = "ðŸ”¥ FlareHub V2",
   LoadingTitle = "FlareHub V2",
   LoadingSubtitle = "Noclip â€¢ Fly â€¢ ESP â€¢ Walkspeed â€¢ Brainrot",
   ConfigurationSaving = { Enabled = true, FolderName = "FlareHub", FileName = "FlareConfig" },
   Discord = { Enabled = false },
   KeySystem = false
})

local Tab = Window:CreateTab("Main", 4483362458)
local BrainrotTab
local player = game:GetService("Players").LocalPlayer
local RunService = game:GetService("RunService")
task.wait(1)

-- GAME DETECTION
local function isStealABrainrot()
   local success, result = pcall(function()
      return game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name:lower()
   end)
   if success then
      local gameName = result:lower()
      return gameName:find("steal") and gameName:find("brainrot")
   end
   return false
end

-- ULTRA SAFE WALKSPD
local function safeSetWalkspeed(humanoid, speed)
   local targetSpeed = math.clamp(speed, 16, 24)
   spawn(function()
      while math.abs(humanoid.WalkSpeed - targetSpeed) > 0.1 do
         local newSpeed = humanoid.WalkSpeed + (targetSpeed - humanoid.WalkSpeed) * 0.03
         newSpeed = newSpeed + math.random(-1, 1) * 0.03
         humanoid.WalkSpeed = math.clamp(newSpeed, 16, 24)
         wait(0.4)
      end
   end)
end

-- STEALTH HITBOX (Anti-detection)
local stealthConnection
local function toggleStealthHitbox(Value)
   if not player.Character then return end
   local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
   if not rootPart then return end
   
   if Value then
      -- STEALTH HITBOX - Network invisible
      rootPart.Anchored = false
      rootPart.CanCollide = false
      
      stealthConnection = RunService.Stepped:Connect(function()
         if player.Character and rootPart.Parent then
            -- Keep hitbox slightly offset (undetectable)
            local head = player.Character:FindFirstChild("Head")
            if head then
               rootPart.CFrame = head.CFrame * CFrame.new(0, -3, 0)
               rootPart.Size = Vector3.new(4, 6, 2)  -- Normal size [web:384]
            end
         end
      end)
      
   else
      if stealthConnection then stealthConnection:Disconnect() end
      rootPart.Anchored = false
      rootPart.CanCollide = true
      rootPart.Size = Vector3.new(2, 2, 1)
   end
end

-- Steal a Brainrot Tab
if isStealABrainrot() then
   BrainrotTab = Window:CreateTab("ðŸ§  Steal a Brainrot", 4483362458)
   
   BrainrotTab:CreateToggle({
      Name = "ðŸ¤– Auto Collect (Safe)",
      CurrentValue = false,
      Flag = "AutoCollectToggle",
      Callback = function(Value)
         getgenv().AutoCollectEnabled = Value
         if Value then
            spawn(function()
               while getgenv().AutoCollectEnabled do
                  pcall(function()
                     for _, obj in pairs(workspace:GetDescendants()) do
                        if obj.Name:lower():find("collect") or obj.Name:lower():find("drop") then
                           local distance = (obj.Position - player.Character.Head.Position).Magnitude
                           if distance < 20 then
                              local clickDetector = obj:FindFirstChildOfClass("ClickDetector")
                              if clickDetector then fireclickdetector(clickDetector) end
                              wait(2)
                              break
                           end
                        end
                     end
                  end)
                  wait(3)
               end
            end)
         end
      end,
   })
end

-- MAIN TAB
Tab:CreateButton({ Name = "âœ… Test GUI", Callback = function() print("FlareHub BYPASS ACTIVE!") end })

-- STEALTH HITBOX (SAB SAFE)
Tab:CreateToggle({
   Name = "ðŸŒŒ Stealth Hitbox",
   CurrentValue = false,
   Flag = "StealthHitboxToggle",
   Callback = function(Value)
      toggleStealthHitbox(Value)
   end,
})

Tab:CreateToggle({
   Name = "âœ¨ Noclip",
   CurrentValue = false,
   Flag = "NoclipToggle",
   Callback = function(Value)
      getgenv().NoclipEnabled = Value
      if Value then
         getgenv().NoclipConnection = RunService.Stepped:Connect(function()
            if player.Character then
               for _, part in pairs(player.Character:GetDescendants()) do
                  if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                     part.CanCollide = false
                  end
               end
            end
         end)
      else 
         if getgenv().NoclipConnection then getgenv().NoclipConnection:Disconnect() end
      end
   end,
})

Tab:CreateSlider({
   Name = "Fly Speed",
   Range = {50, 150},
   Increment = 10,
   CurrentValue = 100,
   Flag = "FlySpeedSlider",
   Callback = function(Value) getgenv().FlySpeed = Value end,
})

-- SAFE FLY
Tab:CreateToggle({
   Name = "ðŸ•Šï¸ Fly",
   CurrentValue = false,
   Flag = "FlyToggle",
   Callback = function(Value)
      getgenv().FlyEnabled = Value
      local character = player.Character or player.CharacterAdded:Wait()
      local humanoid = character:WaitForChild("Humanoid")
      local rootPart = character:WaitForChild("HumanoidRootPart")
      
      if Value then
         humanoid.PlatformStand = true
         
         local bodyVelocity = Instance.new("BodyVelocity")
         bodyVelocity.MaxForce = Vector3.new(2000, 2000, 2000)
         bodyVelocity.Velocity = Vector3.new(0, 0, 0)
         bodyVelocity.Parent = rootPart
         
         local bodyGyro = Instance.new("BodyGyro")
         bodyGyro.MaxTorque = Vector3.new(2000, 2000, 2000)
         bodyGyro.P = 2000
         bodyGyro.D = 300
         bodyGyro.CFrame = rootPart.CFrame
         bodyGyro.Parent = rootPart
         
         getgenv().FlyBodyVelocity = bodyVelocity
         getgenv().FlyBodyGyro = bodyGyro
         
         getgenv().FlyConnection = RunService.Heartbeat:Connect(function()
            local camera = workspace.CurrentCamera
            local moveDir = humanoid.MoveDirection
            local speed = getgenv().FlySpeed or 100
            
            if moveDir.Magnitude > 0.05 then
               local camForward = Vector3.new(camera.CFrame.LookVector.X, 0, camera.CFrame.LookVector.Z).Unit
               local camRight = Vector3.new(camera.CFrame.RightVector.X, 0, camera.CFrame.RightVector.Z).Unit
               local velocity = (camForward * -moveDir.Z + camRight * moveDir.X + Vector3.new(0, moveDir.Y, 0)).Unit * speed
               bodyVelocity.Velocity = velocity
            else
               bodyVelocity.Velocity = Vector3.new(0, 0, 0)
            end
            
            bodyGyro.CFrame = camera.CFrame
         end)
      else
         humanoid.PlatformStand = false
         if getgenv().FlyBodyVelocity then getgenv().FlyBodyVelocity:Destroy() end
         if getgenv().FlyBodyGyro then getgenv().FlyBodyGyro:Destroy() end
         if getgenv().FlyConnection then getgenv().FlyConnection:Disconnect() end
      end
   end,
})

Tab:CreateSlider({
   Name = "Walkspeed (Safe)",
   Range = {16, 24},
   Increment = 1,
   CurrentValue = 16,
   Flag = "WalkspeedSlider",
   Callback = function(Value)
      local humanoid = player.Character and player.Character:FindFirstChild("Humanoid")
      if humanoid then safeSetWalkspeed(humanoid, Value) end
   end,
})

-- SAB SAFE NOTIFICATION
if isStealABrainrot() then
   Rayfield:Notify({
      Title = "ðŸ§  SAB BYPASS ACTIVE",
      Content = "Stealth Hitbox + Anti-Cheat Blocked!",
      Duration = 6
   })
end
