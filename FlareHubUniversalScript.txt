-- üî• FlareHub V2 - INSPIRED BY RAYGULL 99 NIGHTS SCRIPT
getgenv().SecureMode = true

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
Rayfield:LoadConfiguration()

local Window = Rayfield:CreateWindow({
   Name = "üî• FlareHub V2",
   LoadingTitle = "FlareHub V2",
   LoadingSubtitle = "99 Nights ‚Ä¢ ESP ‚Ä¢ Aimbot ‚Ä¢ Auto Farm ‚Ä¢ Teleport",
   ConfigurationSaving = { Enabled = true, FolderName = "FlareHub", FileName = "FlareConfig" },
   Discord = { Enabled = false },
   KeySystem = false
})

local MainTab = Window:CreateTab("üéÆ Main", 4483362458)
local NightsTab = Window:CreateTab("üå≤ 99 Nights", 1398837429)

local player = game:GetService("Players").LocalPlayer
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local camera = workspace.CurrentCamera
task.wait(1)

-- **RAYGULL'S ACTUAL 99 NIGHTS ITEMS** - FROM WORKING SCRIPT [web:13]
local teleportTargets = {
    "Alien", "Alien Chest", "Alien Shelf", "Alpha Wolf", "Alpha Wolf Pelt", "Anvil Base", "Apple", "Bandage", 
    "Bear", "Berry", "Bolt", "Broken Fan", "Broken Microwave", "Bunny", "Bunny Foot", "Cake", "Carrot", 
    "Chair Set", "Chest", "Chilli", "Coal", "Coin Stack", "Crossbow Cultist", "Cultist", "Cultist Gem", 
    "Deer", "Fuel Canister", "Giant Sack", "Good Axe", "Iron Body", "Item Chest", "Item Chest2", 
    "Item Chest3", "Item Chest4", "Item Chest6", "Laser Fence Blueprint", "Laser Sword", "Leather Body", 
    "Log", "Lost Child", "Lost Child2", "Lost Child3", "Lost Child4", "Medkit", "Meat? Sandwich", 
    "Morsel", "Old Car Engine", "Old Flashlight", "Old Radio", "Oil Barrel", "Raygun", "Revolver", 
    "Revolver Ammo", "Rifle", "Rifle Ammo", "Riot Shield", "Sapling", "Seed Box", "Sheet Metal", 
    "Spear", "Steak", "Stronghold Diamond Chest", "Tyre", "UFO Component", "UFO Junk", 
    "Washing Machine", "Wolf", "Wolf Corpse", "Wolf Pelt"
}

-- **STRICT PICKABLE FILTER** - ONLY RAYGULL'S LIST + PHYSICAL CHECK
local function isPickableItem(obj)
    if not obj:IsA("BasePart") then return false end
    if obj.Size.Magnitude < 0.3 or obj.Size.Magnitude > 25 then return false end
    if obj.Parent == player.Character then return false end
    if not obj.Parent then return false end
    
    -- **MUST MATCH RAYGULL'S EXACT LIST**
    for _, targetName in pairs(teleportTargets) do
        if obj.Name == targetName or obj.Name:lower():find(targetName:lower()) then
            -- BLOCK JUNK EVEN FROM LIST
            local junkWords = {"particle", "effect", "light", "fire", "smoke", "glow", "scrapper"}
            for _, junk in pairs(junkWords) do
                if obj.Name:lower():find(junk) then return false end
            end
            return true
        end
    end
    return false
end

local function scanPickableItems()
    local foundItems = {}
    local seen = {}
    
    for _, obj in pairs(workspace:GetChildren()) do
        if isPickableItem(obj) and not seen[obj.Name] then
            seen[obj.Name] = true
            table.insert(foundItems, obj.Name)
        end
    end
    
    table.sort(foundItems)
    return foundItems
end

-- MAIN TAB - UNIVERSAL FEATURES
local MovementSection = MainTab:CreateSection("üèÉ Movement")
MainTab:CreateToggle({
   Name = "Noclip",
   CurrentValue = false,
   Flag = "NoclipMain",
   Callback = function(Value)
      local character = player.Character
      if character then
         local humanoid = character:FindFirstChild("Humanoid")
         if humanoid then humanoid.PlatformStand = Value end
      end
   end
})

MainTab:CreateToggle({
   Name = "Fly (Q Toggle)",
   CurrentValue = false,
   Flag = "FlyMain",
   Callback = function(Value)
      -- RAYGULL FLY LOGIC
      local flying, flyConnection = false, nil
      local speed = 60
      local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
      
      if Value then
         local bodyGyro = Instance.new("BodyGyro", hrp)
         local bodyVelocity = Instance.new("BodyVelocity", hrp)
         bodyGyro.P = 9e4
         bodyGyro.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
         bodyGyro.CFrame = hrp.CFrame
         bodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
         
         flyConnection = RunService.RenderStepped:Connect(function()
            local moveVec = Vector3.zero
            local camCF = camera.CFrame
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveVec += camCF.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveVec -= camCF.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveVec -= camCF.RightVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveVec += camCF.RightVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then moveVec += camCF.UpVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then moveVec -= camCF.UpVector end
            bodyVelocity.Velocity = moveVec.Magnitude > 0 and moveVec.Unit * speed or Vector3.zero
            bodyGyro.CFrame = camCF
         end)
      end
   end
})

-- 99 NIGHTS TAB - RAYGULL FEATURES
if currentGame == "99NIGHTS" then
   local BringSection = NightsTab:CreateSection("üì¶ Bring REAL Items")
   
   local Dropdown
   local function updateDropdown()
      local items = scanPickableItems()
      if #items > 0 then
         Dropdown:Refresh(items, true)
         Dropdown:Set(items[1])
         Rayfield:Notify({Title = "‚úÖ REAL ITEMS", Content = #items .. " PICKABLE (Carrot=Carrot)", Duration = 3})
      else
         Dropdown:Refresh({"No items"}, true)
      end
   end
   
   NightsTab:CreateButton({
      Name = "üîç Scan Pickable Items",
      Callback = updateDropdown
   })
   
   Dropdown = NightsTab:CreateDropdown({
      Name = "üéØ Bring Item",
      Options = {"Scan first"},
      CurrentOption = {"Scan first"},
      Flag = "Bring99Nights",
      Callback = function(Option)
         local selected = Option[1]
         if selected == "Scan first" or selected == "No items" then return end
         
         local root = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
         if not root then return end
         
         local count = 0
         for _, obj in pairs(workspace:GetChildren()) do
            if isPickableItem(obj) and obj.Name == selected then
               obj.CFrame = root.CFrame * CFrame.new(math.random(-3,3), 2, -5)
               count = count + 1
            end
         end
         Rayfield:Notify({Title = "‚úÖ BROUGHT", Content = count .. " " .. selected, Duration = 3})
      end
   })
   
   -- RAYGULL'S QUICK BUTTONS
   NightsTab:CreateButton({
      Name = "üçé Bring Food (Carrot/Apple/Morsel)",
      Callback = function()
         local root = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
         if root then
            local count = 0
            local foods = {"Carrot", "Apple", "Berry", "Morsel", "Steak"}
            for _, obj in pairs(workspace:GetChildren()) do
               if isPickableItem(obj) then
                  for _, food in pairs(foods) do
                     if obj.Name:find(food) then
                        obj.CFrame = root.CFrame * CFrame.new(2, 2, -4)
                        count = count + 1
                        break
                     end
                  end
               end
            end
            Rayfield:Notify({Title = "üçé FOOD", Content = count .. " food!", Duration = 2})
         end
      end
   })
   
   NightsTab:CreateButton({
      Name = "üå≤ Bring Logs/Wood",
      Callback = function()
         local root = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
         if root then
            local count = 0
            for _, obj in pairs(workspace:GetChildren()) do
               if isPickableItem(obj) and obj.Name:find("Log") then
                  obj.CFrame = root.CFrame * CFrame.new(0, 2, -4)
                  count = count + 1
               end
            end
            Rayfield:Notify({Title = "üå≤ LOGS", Content = count .. " logs!", Duration = 2})
         end
      end
   })
   
   -- RAYGULL TELEPORTS SECTION
   local TeleportSection = NightsTab:CreateSection("üß≤ Teleport")
   NightsTab:CreateButton({
      Name = "üèïÔ∏è Campfire",
      Callback = function()
         player.Character:PivotTo(CFrame.new(0, 10, 0))
      end
   })
   
   NightsTab:CreateButton({
      Name = "‚öôÔ∏è Grinder",
      Callback = function()
         player.Character:PivotTo(CFrame.new(16.1,4,-4.6))
      end
   })
   
   -- DYNAMIC TELEPORT FROM RAYGULL LIST
   NightsTab:CreateDropdown({
      Name = "Teleport to Item",
      Options = teleportTargets,
      CurrentOption = {"Apple"},
      Flag = "Teleport99",
      Callback = function(Option)
         local itemName = Option[1]
         local closest, shortest = nil, math.huge
         for _, obj in pairs(workspace:GetDescendants()) do
            if obj.Name == itemName and (obj:IsA("Model") or obj:IsA("BasePart")) then
               local cf = obj:IsA("Model") and obj:GetPivot() or obj.CFrame
               local dist = (cf.Position - player.Character.HumanoidRootPart.Position).Magnitude
               if dist < shortest then
                  closest = cf
                  shortest = dist
               end
            end
         end
         if closest then
            player.Character:PivotTo(closest + Vector3.new(0, 5, 0))
         end
      end
   })
end

print("üî• FlareHub V2 - RAYGULL 99 NIGHTS INSPIRED!")
